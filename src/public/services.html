--//public/services.html-->
<head>
 <title>Community Marketplace</title>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width,
initial-scale=1.0">
 <link rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/c
ss/all.min.css">
 <style>
 :root {
 --primary: #ff6b6b;
 --secondary: #4ecdc4;
 --accent: #ffe66d;
 --light: #f7fff7;
 --dark: #1a535c;
 --purple: #9b5de5;
 --pink: #f15bb5;
 --yellow: #fee440;
 --blue: #00bbf9;
 --mint: #00f5d4;
 }

 * {
 margin: 0;
 padding: 0;
 box-sizing: border-box;
 font-family: 'Segoe UI', Tahoma, Geneva, Verdana,
sans-serif;
 }

 body {
 background: linear-gradient(120deg, var(--light) 0%,
#f0f8ff 100%);
 color: #333;
 }

 nav {
 background: rgba(255, 255, 255, 0.9);
 backdrop-filter: blur(10px);
 width: 100%;
 position: fixed;
 /* Change to fixed position */
 top: 0;
 /* Position at top of viewport */
 padding: 1rem 5%;
 display: flex;
 justify-content: space-between;
 align-items: center;
 z-index: 1000;
 transition: transform 0.4s ease;
 box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
 }

 header {
 background: linear-gradient(135deg, var(--primary),
var(--purple));
 color: white;
 padding: 50px 0 20px 0;
 text-align: center;
 margin-top: 60px;
 }

 .logo {
 font-size: 1.8rem;
 font-weight: 800;
 background: linear-gradient(to right, var(--primary),
var(--purple), var(--blue));
 -webkit-background-clip: text;
 background-clip: text;
 color: transparent;
 letter-spacing: 1px;
 }

 .nav-links {
 display: flex;
 gap: 2rem;
 }

 .nav-links a {
 text-decoration: none;
 color: #22626c;
 font-weight: 600;
 font-size: 1.1rem;
 position: relative;
 padding: 0.5rem 0;
 transition: color 0.3s;
 }

 .nav-links a:hover {
 color: var(--primary);
 }

 .nav-links a::after {
 content: '';
 position: absolute;
 bottom: -2px;
 left: 0;
 width: 0;
 height: 2px;
 background: var(--primary);
 transition: width 0.3s ease;
 }

 .nav-links a:hover::after {
 width: 100%;
 }

 .container {
 max-width: 1200px;
 margin: 0 auto;
 padding: 20px;
 }

 .search-filter {
 display: flex;
 flex-wrap: wrap;
 justify-content: space-between;
 align-items: center;
 margin-bottom: 20px;
 padding: 15px;
 background-color: rgba(255, 255, 255, 0.9);
 border-radius: 8px;
 box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
 }

 .search-box {
 display: flex;
 flex: 1;
 max-width: 600px;
 }

 .search-box input {
 flex: 1;
 padding: 10px;
 border: 1px solid #ddd;
 border-right: none;
 border-radius: 25px 0 0 25px;
 }

 .search-box button {
 padding: 10px 15px;
 background: linear-gradient(to right, var(--secondary),
var(--blue));
 color: white;
 border: none;
 border-radius: 0 25px 25px 0;
 cursor: pointer;
 transition: all 0.3s;
 }

 .search-box button:hover {
 background: linear-gradient(to right, var(--blue),
var(--mint));
 }

 .filter-options {
 display: flex;
 flex-wrap: wrap;
 gap: 10px;
 margin-top: 10px;
 }

 .filter-options select {
 padding: 8px;
 border: 1px solid #ddd;
 border-radius: 25px;
 background-color: white;
 }

 .post-listing {
 display: flex;
 justify-content: center;
 margin-bottom: 20px;
 }

 .post-button {
 padding: 12px 25px;
 background: linear-gradient(to right, var(--primary),
var(--pink));
 color: white;
 border: none;
 border-radius: 25px;
 font-size: 16px;
 font-weight: bold;
 cursor: pointer;
 transition: all 0.3s;
 }

 .post-button:hover {
 background: linear-gradient(to right, var(--pink),
var(--purple));
 transform: translateY(-3px);
 box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
 }

 .categories {
 display: flex;
 overflow-x: auto;
 padding: 10px 0;
 margin-bottom: 20px;
 gap: 15px;
 }

 .category {
 min-width: 120px;
 text-align: center;
 padding: 15px 10px;
 background-color: rgba(255, 255, 255, 0.9);
 border-radius: 8px;
 box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
 cursor: pointer;
 transition: transform 0.3s;
 }

 .category:hover {
 transform: translateY(-5px);
 box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
 }

 .category img {
 width: 50px;
 height: 50px;
 margin-bottom: 10px;
 }

 .listings {
 display: grid;
 grid-template-columns: repeat(auto-fill, minmax(250px,
1fr));
 gap: 20px;
 }

 .listing-card {
 background-color: rgba(255, 255, 255, 0.9);
 border-radius: 8px;
 overflow: hidden;
 box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
 transition: all 0.3s;
 }

 .listing-card:hover {
 transform: translateY(-5px);
 box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
 }

 .listing-image {
 height: 200px;
 background-color: #f0f0f0;
 display: flex;
 align-items: center;
 justify-content: center;
 }

 .listing-image img {
 max-width: 100%;
 max-height: 100%;
 }

 .listing-details {
 padding: 15px;
 }.listing-title {
 font-size: 18px;
 margin-bottom: 10px;
 color: var(--dark);
 font-weight: 600;
 }

 .listing-price {
 font-size: 20px;
 font-weight: bold;
 color: var(--primary);
 margin-bottom: 10px;
 }

 .listing-location {
 display: flex;
 align-items: center;
 color: #666;
 font-size: 14px;
 margin-bottom: 10px;
 }

 .listing-seller {
 display: flex;
 align-items: center;
 margin-top: 10px;
 }

 .seller-avatar {
 width: 30px;
 height: 30px;
 border-radius: 50%;
 background: linear-gradient(135deg, var(--blue),
var(--mint));
 margin-right: 10px;
 }

 .seller-name {
 font-size: 14px;
 color: #666;
 }

 .section-title {
 margin: 30px 0 15px 0;
 border-bottom: 2px solid;
 border-image: linear-gradient(to right, var(--primary),
var(--purple)) 1;
 padding-bottom: 10px;
 color: var(--dark);
 font-weight: 600;
 }

 .sold-out {
 position: absolute;
 top: 10px;
 right: 10px;
 background: linear-gradient(to right, #f44336,
var(--primary));
 color: white;
 padding: 5px 15px;
 border-radius: 25px;
 font-weight: bold;
 }

 .popular-tag {
 position: absolute;
 top: 10px;
 right: 10px;
 background: linear-gradient(to right, #ff9800,
var(--yellow));
 color: white;
 padding: 5px 15px;
 border-radius: 25px;
 font-weight: bold;
 }

 .view-more {
 display: block;
 text-align: center;
 margin: 20px auto;
 padding: 10px 20px;
 background: linear-gradient(to right, var(--dark),
var(--secondary));
 color: white;
 border: none;
 border-radius: 25px;
 cursor: pointer;
 width: 200px;
 transition: all 0.3s;
 }

 .view-more:hover {
 background: linear-gradient(to right, var(--secondary),
var(--purple));
 transform: translateY(-3px);
 box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
 }
 /* Modal Styles */

 .modal {
 display: none;
 position: fixed;
 top: 0;
 left: 0;
 width: 100%;
 height: 100%;
 background: rgba(0, 0, 0, 0.7);
 z-index: 1000;
 padding: 20px;
 overflow-y: auto;
 backdrop-filter: blur(5px);
 }

 .modal-content {
 background: white;
 padding: 25px;
 border-radius: 8px;
 max-width: 500px;
 margin: 50px auto;
 box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
 animation: fadeIn 0.3s ease;
 }

 @keyframes fadeIn {
 from {
 opacity: 0;
 transform: translateY(-20px);
 }
 to {
 opacity: 1;
 transform: translateY(0);
 }
 }

 .modal-content h2 {
 margin-bottom: 15px;
 color: var(--primary);
 }

 .modal-content input,
 .modal-content textarea,
 .modal-content select {
 width: 100%;
 padding: 10px;
 margin-bottom: 10px;
 border: 1px solid #ddd;
 border-radius: 25px;
 }

 .modal-content button {
 background: linear-gradient(to right, var(--primary),
var(--pink));
 color: white;
 border: none;
 padding: 10px 20px;
 border-radius: 25px;
 cursor: pointer;
 margin-right: 10px;
 transition: all 0.3s;
 }

 .modal-content button:hover {
 background: linear-gradient(to right, var(--pink),
var(--purple));
 transform: translateY(-2px);
 }

 .button-group {
 display: flex;
 justify-content: space-between;
 margin-top: 15px;}

 .button-cancel {
 background: linear-gradient(to right, #f44336,
var(--primary)) !important;
 }

 .button-cancel:hover {
 background: linear-gradient(to right, #d32f2f, #f44336)
!important;
 }

 .footer {
 background: #2d889887;
 color: rgb(255, 255, 255);
 padding: 4rem 1rem 2rem;
 position: relative;
 overflow: hidden;
 width: 100%;
 margin-top: 40px;
 margin-right: 0px;
 }

 .footer::before {
 content: '';
 position: absolute;
 top: 0;
 left: 0;
 right: 0;
 height: 4px;
 background: linear-gradient(to right, var(--primary),
var(--purple), var(--blue));
 }

 .footer-content {
 max-width: 1200px;
 margin: 0 auto;
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(250px,
1fr));
 gap: 2rem;
 position: relative;
 z-index: 1;
 }

 .footer-section {
 padding: 1rem;
 }

 .footer-title {
 font-size: 1.5rem;
 margin-bottom: 1rem;
 color: var(--accent);
 position: relative;
 display: inline-block;
 }

 .footer-title::after {
 content: '';
 position: absolute;
 bottom: -5px;
 left: 0;
 width: 40px;
 height: 3px;
 background: linear-gradient(to right, var(--pink),
var(--purple));
 border-radius: 3px;
 }

 .footer-links {
 list-style: none;
 }

 .footer-links li {
 margin-bottom: 0.8rem;
 display: flex;
 align-items: center;
 }

 .footer-links i {
 margin-right: 0.5rem;
 color: var(--accent);
 }

 .footer-links a {
 color: white;
 text-decoration: none;
 transition: all 0.3s;
 position: relative;
 }

 .footer-links a::after {
 content: '';
 position: absolute;
 bottom: -2px;
 left: 0;
 width: 0;
 height: 2px;
 background: var(--accent);
 transition: width 0.3s ease;
 }

 .footer-links a:hover::after {
 width: 100%;
 }

 .social-links {
 display: flex;
 gap: 1rem;
 margin-top: 1rem;
 }

 .social-links a {
 width: 40px;
 height: 40px;
 border-radius: 50%;
 background: rgba(255, 255, 255, 0.1);
 display: flex;
 align-items: center;
 justify-content: center;
 color: white;
 text-decoration: none;
 transition: all 0.3s;
 border: 1px solid rgba(255, 255, 255, 0.1);
 }

 .social-links a:hover {
 background: var(--accent);
 color: var(--dark);
 transform: translateY(-3px) rotate(8deg);
 border-color: var(--accent);
 }

 .footer-bottom {
 text-align: center;
 padding-top: 2rem;
 margin-top: 2rem;
 border-top: 1px solid rgba(255, 255, 255, 0.1);
 position: relative;
 }

 @media (max-width: 768px) {
 .listings {
 grid-template-columns: repeat(auto-fill, minmax(200px,
1fr));
 }
 .search-filter {
 flex-direction: column;
 align-items: stretch;
 }
 .search-box {
 max-width: 100%;
 margin-bottom: 10px;
 }
 .modal-content {
 width: 95%;
 margin: 20px auto;
 }
 }

 .user-menu {
 position: relative;
 display: inline-block;
 }

 .user-dropdown {
 display: none;
 position: absolute;
 top: 100%;
 right: 0;
 background: white;
 border-radius: 8px;box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
 min-width: 150px;
 z-index: 1000;
 margin-top: 0.5rem;
 }

 .user-dropdown.active {
 display: block;
 }

 .user-dropdown a {
 display: block;
 padding: 0.8rem 1.2rem;
 color: #22626c;
 text-decoration: none;
 transition: background-color 0.3s;
 }

 .user-dropdown a:hover {
 background-color: #f5f5f5;
 color: var(--primary);
 }

 .dropdown {
 position: relative;
 display: inline-block;
 }

 .dropbtn {
 background-color: #45b3b3;
 color: white;
 padding: 10px;
 font-size: 16px;
 border: none;
 cursor: pointer;
 }

 .dropdown-content {
 display: none;
 position: absolute;
 background-color: white;
 min-width: 150px;
 box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
 z-index: 1;
 }

 .dropdown-content a {
 color: black;
 padding: 10px;
 text-decoration: none;
 display: block;
 }

 .dropdown-content a:hover {
 background-color: #ddd;
 }
 /* Show dropdown only when the "show" class is present */

 .show {
 display: block;
 }
 </style>
</head>
<body>
 <nav id="navbar">
 <div class="logo">EventPulse</div>
 <div class="nav-links">
 <a href="home.html">Home</a>
 <a href="events.html">Events</a>
 <a href="donate.html">Donate</a>
 <a href="about.html">About</a>
 <a href="contact.html">Contact</a>
 <a href="index.html" id="inside">SignUp/Login</a>
 </div>
 </nav>
 <header>
 <div class="container">
 <h1>Community Marketplace</h1>
 <p>Buy, sell, and support local businesses in our
community</p>
 </div>
 </header>
 <div class="container"><div class="search-filter">
 <div class="search-box">
 <input type="text" id="searchInput" placeholder="Search
for items, services, or businesses...">
 <button onclick="searchListings()">Search</button>
 </div>
 <div class="filter-options">
 <select id="categorySelect"
onchange="filterListings()">
 <option value="">All Categories</option>
 <option value="items">Items for Sale</option>
 <option value="services">Services</option>
 </select>
 <select id="sortSelect" onchange="sortListings()">
 <option value="">Sort By</option>
 <option value="recent">Most Recent</option>
 <option value="price-low">Price: Low to High</option>
 <option value="price-high">Price: High to Low</option>
 <option value="popular">Most Popular</option>
 </select>
 </div>
 </div>
 <div class="post-listing">
 <button class="post-button" onclick="openModal()">+ Post
New Listing</button>
 </div>
 <div class="categories">
 <div class="category"
onclick="filterByCategory('furniture')">
 <img src="./images/furniture.jpg" alt="Furniture">
 <h3>Furniture</h3>
 </div>
 <div class="category"
onclick="filterByCategory('electronics')">
 <img src="./images/electronics.jpg" alt="Electronics">
 <h3>Electronics</h3>
 </div>
 <div class="category"
onclick="filterByCategory('clothing')">
 <img src="./images/clothes.jpg" alt="Clothing">
 <h3>Clothing</h3>
 </div>
 <div class="category"
onclick="filterByCategory('services')">
 <img src="./images/homeservices.jpg" alt="Home
Services">
 <h3>Home Services</h3>
 </div>
 <div class="category"
onclick="filterByCategory('education')">
 <img src="./images/tutoring.jpg" alt="Tutoring">
 <h3>Tutoring</h3>
 </div>
 <div class="category"
onclick="filterByCategory('businesses')">
 <img src="./images/local shops.jpg" alt="Local Shops">
 <h3>Local Shops</h3>
 </div>
 <div class="category"
onclick="filterByCategory('handmade')">
 <img src="./images/handmade.jpg" alt="Handmade">
 <h3>Handmade</h3>
 </div>
 <div class="category" onclick="filterByCategory('food')">
 <img src="./images/dine.jpg" alt="Food & Dining">
 <h3>Food & Dining</h3>
 </div>
 </div>
 <h2 class="section-title">Featured Items For Sale</h2>
 <div class="listings" id="itemsListings">
 </div>
 <h2 class="section-title">Services</h2>
 <div class="listings" id="servicesListings">
 <!-- Services will be displayed here -->
 </div>
 <!-- Modal for listing form -->
 <div class="modal" id="listingModal">
 <div class="modal-content">
 <h2>Add New Listing</h2>
 <form id="newListingForm" onsubmit="addListing(event)">
 <input type="text" id="title" placeholder="Title"
required>
 <textarea id="description"
placeholder="Description" required></textarea>
 <input type="number" id="price" placeholder="Price"
required min="0" step="0.01">
 <input type="text" id="location"
placeholder="Location">
 <select id="listingType"
onchange="updateCategoryOptions()">
 <option value="items">Item for Sale</option>
 <option value="services">Service</option>
 </select>
 <select id="category">
 <!-- Categories will be populated by JavaScript -->
 </select>
 <input type="text" id="sellerPhone"
placeholder="Seller Phone" required>
 <input type="email" id="sellerEmail"
placeholder="Seller Email" required>
 <div class="button-group">
 <button type="submit">Submit Listing</button>
 <button type="button" class="button-cancel"
onclick="closeModal()">Cancel</button>
 </div>
 </form>
 </div>
 </div>
 </div>
 <footer class="footer">
 <div class="footer-content">
 <div class="footer-section">
 <h3 class="footer-title">EventPulse</h3>
 <p>Empowering communities through meaningful
connections and impactful events.</p>
 <div class="social-links">
 <a href="#"><i class="fab fa-facebook-f"></i></a>
 <a href="#"><i class="fab fa-twitter"></i></a>
 <a href="#"><i class="fab fa-instagram"></i></a>
 <a href="#"><i class="fab fa-linkedin-in"></i></a>
 </div>
 </div>
 <div class="footer-section">
 <h3 class="footer-title">Quick Links</h3>
 <ul class="footer-links">
 <li><a href="home.html">Home</a></li>
 <li><a href="events.html">Events</a></li>
 <li><a href="donate.html">Donate</a></li>
 <li><a href="about.html">About Us</a></li>
 <li><a href="contact.html">Contact</a></li>
 <li><a href="index.html">SignUp/Login</a></li>
 </ul>
 </div>
 </div>
 </footer>
 <script>
 // Global variables to store listings
 let allListings = [];
 // Categories for different listing types
 const categoryOptions = {
 items: [
 'Furniture', 'Electronics', 'Clothing', 'Books',
 'Home Goods', 'Food', 'Handmade', 'Other'
 ],
 services: [
 'services', 'Tutoring', 'Gardening', 'Cleaning',
 'Local Shops', 'Photography', 'Web Design', 'Other'
 ]
 };
 // Function to update category options based on listing type
 function updateCategoryOptions() {
 const listingType =
document.getElementById('listingType').value;
 const categorySelect = document.getElementById('category');
 // Clear existing options
 categorySelect.innerHTML = '';
 // Populate with new options
 categoryOptions[listingType].forEach(category => {const option = document.createElement('option');
 option.value = category.toLowerCase();
 option.textContent = category;
 categorySelect.appendChild(option);
 });
 }
 // Initialize page
 document.addEventListener('DOMContentLoaded', () => {
 // Set initial category options
 updateCategoryOptions();
 // Load initial listings
 loadInitialListings();
 // Add event listener for search input

document.getElementById('searchInput').addEventListener('input',
searchListings);
 // Create and append listing details modal
 createListingDetailsModal();
 // Add event listener for listing type change

document.getElementById('listingType').addEventListener('change',
filterListingsByType);
 });
 // Filter listings by type
 function filterListingsByType() {
 const listingType =
document.getElementById('listingType').value;
 // Clear existing listings
 document.getElementById('itemsListings').innerHTML = '';
 document.getElementById('servicesListings').innerHTML = '';
 // Filter and render listings
 const filteredListings = allListings.filter(listing =>
 listing.type === listingType
 );
 // Render filtered listings
 filteredListings.forEach(renderListing);
 }
 // Create listing details modal
 function createListingDetailsModal() {
 const modalDiv = document.createElement('div');
 modalDiv.id = 'listingDetailsModal';
 modalDiv.className = 'modal';
 modalDiv.innerHTML = `
 <div class="modal-content">
 <span class="close-modal"
onclick="closeListingDetailsModal()">&times;</span>
 <h2 id="detailModalTitle">Listing Details</h2>
 <div id="detailModalContent">
 <p id="detailModalDescription"></p>
 <div id="detailModalPrice"></div>
 <div id="detailModalLocation"></div>
 <div id="detailModalSeller"></div>
 <div id="detailModalCategory"></div>
 <div id="detailModalDate"></div>
 </div>
 <div class="button-group">
 <button onclick="contactSeller()">Contact Seller</button>
 <button class="button-cancel"
onclick="closeListingDetailsModal()">Close</button>
 </div>
 <div id="sellerContactInfo" style="display:none; margin-top:
15px; padding: 10px; background-color: #f4f4f4; border-radius: 5px;">
 <h3>Seller Contact Information</h3>
 <p id="sellerPhoneDisplay"></p>
 <p id="sellerEmailDisplay"></p>
 </div>
 </div>
 `;
 document.body.appendChild(modalDiv);
 // Add some CSS for the close button
 const style = document.createElement('style');
 style.textContent = `
 .close-modal {
 color: #aaa;
 float: right;
 font-size: 28px;
 font-weight: bold;
 cursor: pointer;
 }
 .close-modal:hover {
 color: black;
 }
 `;
 document.head.appendChild(style);
 }
 // Open listing details modal
 async function openListingDetails(listingId) {
 try {
 console.log(`Fetching details for listing ID:
${listingId}`);
 const response = await
fetch(`${API_URL}/${listingId}`);
 if (!response.ok) {
 throw new Error('Failed to fetch listing details');
 }
 const listing = await response.json();
 console.log('Fetched listing details:', listing);
 const modal =
document.getElementById('listingDetailsModal');
 document.getElementById('detailModalTitle').textContent
= listing.title;

document.getElementById('detailModalDescription').textContent =
listing.description;
 document.getElementById('detailModalPrice').innerHTML =
`<strong>Price:</strong> $${listing.price.toFixed(2)}`;

document.getElementById('detailModalLocation').innerHTML =
`<strong>Location:</strong> ${listing.location}`;
 document.getElementById('detailModalSeller').innerHTML
= `<strong>Seller:</strong> ${listing.seller}`;

document.getElementById('detailModalCategory').innerHTML =
`<strong>Category:</strong> ${listing.category}`;
 // Format date for display
 const postedDate = new
Date(listing.datePosted).toLocaleDateString();
 document.getElementById('detailModalDate').innerHTML =
`<strong>Posted:</strong> ${postedDate}`;
 // Hide contact info initially

document.getElementById('sellerContactInfo').style.display = 'none';
 modal.style.display = 'block';
 } catch (error) {
 console.error('Error loading listing details:', error);
 }
 }
 // Close listing details modal
 function closeListingDetailsModal() {

document.getElementById('listingDetailsModal').style.display = 'none';
 }
 // Contact seller function
 function contactSeller() {
 const contactInfoDiv =
document.getElementById('sellerContactInfo');
 const currentListing = allListings.find(l => l.title ===
document.getElementById('detailModalTitle').textContent);
 if (currentListing && currentListing.contactInfo) {
 document.getElementById('sellerPhoneDisplay').innerHTML
= `<strong>Phone:</strong> ${currentListing.contactInfo.phone}`;
 document.getElementById('sellerEmailDisplay').innerHTML
= `<strong>Email:</strong> ${currentListing.contactInfo.email}`;
 contactInfoDiv.style.display = 'block';
 } else {
 alert('Contact information not available for this seller.');
 }
 }
 // Function to open listing modal
 function openModal() {
 document.getElementById('listingModal').style.display =
'block';
 }
 // Function to close listing modal
 function closeModal() {
 document.getElementById('listingModal').style.display =
'none';
 }
 // Render a single listing
 function renderListing(listing) {
 const container = listing.type === 'services' ?
 document.getElementById('servicesListings') :
 document.getElementById('itemsListings');
 const listingCard = document.createElement('div');
 listingCard.className = 'listing-card';
 listingCard.setAttribute('data-listing-id', listing._id);
// Ensure the correct ID is used
 listingCard.innerHTML = `
 <div class="listing-image">
 <img src="./images/cart.webp" alt="${listing.title}">
 </div>
 <div class="listing-details">
 <h3 class="listing-title">${listing.title}</h3>
 <div class="listing-price">‚Çπ${listing.price.toFixed(2)}</div>
 <div class="listing-location">
 <i class="location-icon">üìç</i> ${listing.location}
 </div>
 <div class="listing-seller">
 <div class="seller-avatar"></div>
 <div class="seller-name">${listing.seller}</div>
 </div>
 </div>
 `;
 // Add click event to open listing details
 listingCard.addEventListener('click', () => {console.log(`Listing card clicked: ${listing._id}`);
 openListingDetails(listing._id);
 });
 container.appendChild(listingCard);
 }
 // Add new listing to API
 async function addListing(event) {
 event.preventDefault();
 // Collect form data
 const newListing = {
 title: document.getElementById('title').value,
 description:
document.getElementById('description').value,
 price:
parseFloat(document.getElementById('price').value),
 location: document.getElementById('location').value,
 type: document.getElementById('listingType').value,
 category: document.getElementById('category').value,
 seller: 'Current User', // In a real app, this would be the logged-in user
 contactInfo: {
 phone:
document.getElementById('sellerPhone').value,
 email: document.getElementById('sellerEmail').value
 }
 };
 try {
 const response = await fetch(API_URL, {
 method: 'POST',
 headers: {
 'Content-Type': 'application/json'
 },
 body: JSON.stringify(newListing)
 });
 if (!response.ok) {
 throw new Error('Failed to add listing');
 }
 const savedListing = await response.json();
 // Add to listings array
 allListings.push(savedListing);
 // Render the new listing
 renderListing(savedListing);
 // Close modal and reset form
 closeModal();
 document.getElementById('newListingForm').reset();
 // Update category options
 updateCategoryOptions();
 } catch (error) {
 console.error('Error adding listing:', error);
 alert('Failed to add listing. Please try again.');
 }
 }
 // API URL
 const API_URL = 'http://localhost:3000/api/listings';
 // Load listings from API
 async function loadInitialListings() {
 try {
 const response = await fetch(API_URL);
 if (!response.ok) {
 throw new Error('Failed to fetch listings');
 }
 allListings = await response.json();
 // Clear existing listings
 document.getElementById('itemsListings').innerHTML =
'';
 document.getElementById('servicesListings').innerHTML =
'';
 // Render fetched listings
 allListings.forEach(renderListing);
 } catch (error) {
 console.error('Error loading listings:', error);
 }
 }
 // Search listings from API
 async function searchListings() {
 const searchTerm =
document.getElementById('searchInput').value.toLowerCase();
 if (!searchTerm) {
 // If search is empty, load all listings
 return loadInitialListings();
 }
 try {
 const response = await
fetch(`${API_URL}/search?term=${searchTerm}`);
 if (!response.ok) {
 throw new Error('Search failed');
 }
 const filteredListings = await response.json();
 // Clear existing listings
 document.getElementById('itemsListings').innerHTML =
'';
 document.getElementById('servicesListings').innerHTML =
'';
 // Update global listings array
 allListings = filteredListings;
 // Render filtered listings
 filteredListings.forEach(renderListing);
 } catch (error) {
 console.error('Error searching listings:', error);
 }
 }
 // Filter listings by type from API
 async function filterListingsByType() {
 const listingType =
document.getElementById('listingType').value;
 try {
 const response = await
fetch(`${API_URL}/type/${listingType}`);
 if (!response.ok) {
 throw new Error('Failed to filter listings');
 }
 const filteredListings = await response.json();
 // Clear existing listings
 document.getElementById('itemsListings').innerHTML =
'';
 document.getElementById('servicesListings').innerHTML =
'';
 // Update global listings array
 allListings = filteredListings;
 // Render filtered listings
 filteredListings.forEach(renderListing);
 } catch (error) {
 console.error('Error filtering listings:', error);
 }
 }
 // Filter listings by category from API
 async function filterByCategory(category) {
 try {
 const response = await
fetch(`${API_URL}/category/${category}`);
 if (!response.ok) {
 throw new Error('Failed to filter by category');
 }
 const filteredListings = await response.json();
 // Clear existing listings
 document.getElementById('itemsListings').innerHTML =
'';
 document.getElementById('servicesListings').innerHTML =
'';
 // Update global listings array
 allListings = filteredListings;
 // Render filtered listings
 filteredListings.forEach(renderListing);
 } catch (error) {
 console.error('Error filtering by category:', error);
 }
 }
 // Sort listings
 function sortListings() {
 const sortOption =
document.getElementById('sortSelect').value;
 switch (sortOption) {
 case 'price-low':
 allListings.sort((a, b) => a.price - b.price);
 break;
 case 'price-high':
 allListings.sort((a, b) => b.price - a.price);
 break;
 case 'recent':
 allListings.sort((a, b) => new Date(b.datePosted) -
new Date(a.datePosted));
 break;
 case 'popular':
 // In a real app, this would be based on view count or interactions
 break;
 }
 // Clear and re-render listings
 document.getElementById('itemsListings').innerHTML = '';
 document.getElementById('servicesListings').innerHTML = '';
 allListings.forEach(renderListing);
 }
 ////////////////
 function updateUserInterface() {
 const loginButton = document.getElementById('loginButton');
 const userDropdown =
document.getElementById('userDropdown');
 if (isLoggedIn && currentUser) {
 loginButton.textContent = currentUser.name;
 loginButton.classList.add('logged-in');
 } else {
 loginButton.textContent = 'Sign Up/Login';
 loginButton.classList.remove('logged-in');
 }
 }
 function showSuccessMessage(message) {
 const successMessage =
document.getElementById('successMessage');
 successMessage.textContent = message;
 successMessage.style.display = 'block';
 setTimeout(() => {
 successMessage.style.display = 'none';
 }, 3000);
 }
 function handleLogout() {
 isLoggedIn = false;
 currentUser = null;
 updateUserInterface();
 showSuccessMessage('Successfully logged out!');
 setTimeout(() => {
 window.location.reload();
 }, 1500);
 }
 // Event Listeners
 document.addEventListener('DOMContentLoaded', () => {
 const loginButton = document.getElementById('loginButton');
 const userDropdown =
document.getElementById('userDropdown');
 const logoutLink = document.getElementById('logoutLink');
 // Toggle dropdown
 loginButton.addEventListener('click', () => {
 if (isLoggedIn) {
 userDropdown.classList.toggle('active');
 }
 });
 // Close dropdown when clicking outside
 document.addEventListener('click', (event) => {
 if (!event.target.closest('.user-menu')) {
 userDropdown.classList.remove('active');
 }
 });
 // Handle logout
 logoutLink.addEventListener('click', (e) => {
 e.preventDefault();
 handleLogout();
 });
 // Add form submission handlers
 const loginForm = document.querySelector('.card-front.form-section');
 const signupForm = document.querySelector('.card-back.form-section');
 loginForm.querySelector('button').addEventListener('click',
(e) => handleAuth(e, false));

signupForm.querySelector('button').addEventListener('click', (e) =>
handleAuth(e, true));
 });
 // Homepage: Retrieve and display user email
 window.onload = function() {
 let email = localStorage.getItem("userEmail");
 if (email) {
 alert("hello " + email);
 }
 };
 const user = JSON.parse(localStorage.getItem('user'));if (user) {
 // Set username text
 document.getElementById("inside").textContent = "";
 // Create dropdown structure
 const dropdown = document.createElement("div");
 dropdown.classList.add("dropdown");
 dropdown.innerHTML = `
 <button class="dropbtn" id="profileBtn">${user.username}
‚ñº</button>
 <div class="dropdown-content" id="dropdownMenu">
 <a href="/profile.html">Profile</a>
 <a href="/index.html" id="logout">Logout</a>
 </div>
 `;
 document.getElementById("inside").appendChild(dropdown);
 // Toggle dropdown visibility on button click

document.getElementById("profileBtn").addEventListener("click", (event)=> {
 event.preventDefault();
 event.stopPropagation();

document.getElementById("dropdownMenu").classList.toggle("show");
 });
 // Close dropdown when clicking outside
 document.addEventListener("click", (event) => {
 if (!dropdown.contains(event.target)) {

document.getElementById("dropdownMenu").classList.remove("show");
 }
 });

document.getElementById("profileLink").addEventListener("click", () =>
{
 window.location.href = "profile.html";
 });
 // Logout functionality
 document.getElementById("logout").addEventListener("click",
() => {
 localStorage.removeItem("user");
 alert("You have been logged out!");
 window.location.href = "/login.html";
 });
 }
 </script>
</body>